{{ partial "header.html" . }}

{{ if not .IsHome }}
<h1>{{ .Title | markdownify }}</h1>
{{ end }}

{{ partial "work_in_progress.html" . }}

{{ .Content }}

<!-- Support Buttons -->
<div class="support-buttons">
  <a href="https://github.com/sponsors/anantshri" target="_blank" rel="noopener" class="sponsor-btn sponsor-github">
    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
      <path fill-rule="evenodd" d="M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.75.75 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5zM8 14.25l-.345.666-.002-.001-.006-.003-.018-.01a7.643 7.643 0 01-.31-.17 22.075 22.075 0 01-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.08 22.08 0 01-3.744 2.584l-.018.01-.006.003h-.002L8 14.25zm0 0l.345.666a.752.752 0 01-.69 0L8 14.25z"></path>
    </svg>
    GitHub Sponsors
  </a>
  <a href="https://www.buymeacoffee.com/anantshri" target="_blank" rel="noopener" class="sponsor-btn sponsor-coffee">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
      <path d="M20.216 6.415l-.132-.666c-.119-.598-.388-1.163-1.001-1.379-.197-.069-.42-.098-.57-.241-.152-.143-.196-.366-.231-.572-.065-.378-.125-.756-.192-1.133-.057-.325-.102-.69-.25-.987-.195-.4-.597-.634-.996-.788a5.723 5.723 0 00-.626-.194c-1-.263-2.05-.36-3.077-.416a25.834 25.834 0 00-3.7.062c-.915.083-1.88.184-2.75.5-.318.116-.646.256-.888.501-.297.302-.393.77-.177 1.146.154.267.415.456.692.58.36.162.737.284 1.123.366 1.075.238 2.189.331 3.287.37 1.218.05 2.437.01 3.65-.118.299-.033.598-.073.896-.119.352-.054.578-.513.474-.834-.124-.383-.457-.531-.834-.473-.466.074-.96.108-1.382.146-1.177.08-2.358.082-3.536.006a22.228 22.228 0 01-1.157-.107c-.086-.01-.18-.025-.258-.036-.243-.036-.484-.08-.724-.13-.111-.027-.111-.185 0-.212h.005c.277-.06.557-.108.838-.147h.002c.131-.009.263-.032.394-.048a25.076 25.076 0 013.426-.12c.674.019 1.347.067 2.017.144l.228.031c.267.04.533.088.798.145.392.085.895.113 1.07.542.055.137.08.288.111.431l.319 1.484a.237.237 0 01-.199.284h-.003c-.037.006-.075.01-.112.015a36.704 36.704 0 01-4.743.295 37.059 37.059 0 01-4.699-.304c-.14-.017-.293-.042-.417-.06-.326-.048-.65-.104-.973-.16-.393-.07-.67.479-.355.766.186.17.378.331.574.484 1.287.991 2.812 1.555 4.387 1.918a24.68 24.68 0 005.06.465c.99-.012 1.975-.089 2.953-.219.35-.046.668-.13.996-.205.235-.054.472-.103.707-.158.423-.098.844-.199 1.256-.329.363-.116.741-.243.986-.563.204-.27.244-.64.196-.966l-.156-.746z"></path>
      <path d="M7.5 20.25c0 .414.336.75.75.75h7.5a.75.75 0 000-1.5h-7.5a.75.75 0 00-.75.75zM8 18h8v-1H8v1z"></path>
      <path d="M6 18.75V8h12v10.75c0 .966-.784 1.75-1.75 1.75H7.75A1.75 1.75 0 016 18.75z"></path>
    </svg>
    Buy Me a Coffee
  </a>
</div>

{{ $pages := where .Pages "Section" "!=" "" }}
{{ if .IsHome }}
  {{ $pages = .Site.RegularPages }}
{{ end }}

<!-- Separate active and discontinued projects -->
{{ $activeProjects := slice }}
{{ $discontinuedProjects := slice }}

{{ range $pages }}
  {{ $status := .Params.status | default "active" }}
  {{ if eq $status "discontinued" }}
    {{ $discontinuedProjects = $discontinuedProjects | append . }}
  {{ else }}
    {{ $activeProjects = $activeProjects | append . }}
  {{ end }}
{{ end }}

<!-- Get featured projects from frontmatter -->
{{ $featuredSlugs := .Params.featured_projects | default slice }}

<!-- Separate featured and non-featured projects -->
{{ $featuredProjects := slice }}
{{ $nonFeaturedProjects := slice }}

{{ range $activeProjects }}
  {{ $slug := .File.BaseFileName }}
  {{ if in $featuredSlugs $slug }}
    {{ $featuredProjects = $featuredProjects | append . }}
  {{ else }}
    {{ $nonFeaturedProjects = $nonFeaturedProjects | append . }}
  {{ end }}
{{ end }}

<!-- Mosaic Gallery -->
<div class="gallery-mosaic">
  <!-- Featured projects first (large tiles) -->
  {{ range $featuredProjects }}
    <div class="gallery-item gallery-item-large">
      <a href="{{ .RelPermalink }}" class="gallery-link">
        {{ if .Params.featured_image }}
          {{ $img := resources.Get .Params.featured_image }}
          {{ if $img }}
            {{ if eq $img.MediaType.SubType "svg" }}
              <img src="{{ $img.RelPermalink }}" alt="{{ .Title }}" class="gallery-img" />
            {{ else }}
              <img src="{{ ($img.Resize "400x q85").RelPermalink }}" alt="{{ .Title }}" class="gallery-img" />
            {{ end }}
          {{ else }}
            <div class="gallery-placeholder">
              <span>{{ .Title }}</span>
            </div>
          {{ end }}
        {{ else }}
          <div class="gallery-placeholder">
            <span>{{ .Title }}</span>
          </div>
        {{ end }}
        <div class="gallery-overlay">
          <h3 class="gallery-title">{{ .Title }}</h3>
          {{ if .Params.tldr_description }}
            <p class="gallery-desc">{{ .Params.tldr_description | truncate 80 }}</p>
          {{ end }}
          {{ if .Params.focus_area }}
            <span class="gallery-badge">{{ .Params.focus_area }}</span>
          {{ end }}
        </div>
      </a>
    </div>
  {{ end }}
  
  <!-- Non-featured projects (regular tiles) -->
  {{ $index := 0 }}
  {{ range $nonFeaturedProjects }}
    {{ $spanClass := "gallery-item" }}
    {{ if eq (mod $index 7) 0 }}
      {{ $spanClass = "gallery-item gallery-item-wide" }}
    {{ end }}
    
    <div class="{{ $spanClass }}">
      <a href="{{ .RelPermalink }}" class="gallery-link">
        {{ if .Params.featured_image }}
          {{ $img := resources.Get .Params.featured_image }}
          {{ if $img }}
            {{ if eq $img.MediaType.SubType "svg" }}
              <img src="{{ $img.RelPermalink }}" alt="{{ .Title }}" class="gallery-img" />
            {{ else }}
              <img src="{{ ($img.Resize "400x q85").RelPermalink }}" alt="{{ .Title }}" class="gallery-img" />
            {{ end }}
          {{ else }}
            <div class="gallery-placeholder">
              <span>{{ .Title }}</span>
            </div>
          {{ end }}
        {{ else }}
          <div class="gallery-placeholder">
            <span>{{ .Title }}</span>
          </div>
        {{ end }}
        <div class="gallery-overlay">
          <h3 class="gallery-title">{{ .Title }}</h3>
          {{ if .Params.tldr_description }}
            <p class="gallery-desc">{{ .Params.tldr_description | truncate 80 }}</p>
          {{ end }}
          {{ if .Params.focus_area }}
            <span class="gallery-badge">{{ .Params.focus_area }}</span>
          {{ end }}
        </div>
      </a>
    </div>
    {{ $index = add $index 1 }}
  {{ end }}
</div>

{{ if $discontinuedProjects }}
<div class="discontinued-strip">
  <h3 class="discontinued-title">Discontinued Projects</h3>
  <div class="discontinued-scroll">
    {{ range $discontinuedProjects }}
      <a href="{{ .RelPermalink }}" class="discontinued-item" title="{{ .Title }}">
        {{ if .Params.featured_image }}
          {{ $img := resources.Get .Params.featured_image }}
          {{ if $img }}
            {{ if eq $img.MediaType.SubType "svg" }}
              <img src="{{ $img.RelPermalink }}" alt="{{ .Title }}" />
            {{ else }}
              <img src="{{ ($img.Resize "100x q80").RelPermalink }}" alt="{{ .Title }}" />
            {{ end }}
          {{ else }}
            <div class="disc-placeholder">{{ substr .Title 0 2 }}</div>
          {{ end }}
        {{ else }}
          <div class="disc-placeholder">{{ substr .Title 0 2 }}</div>
        {{ end }}
      </a>
    {{ end }}
  </div>
</div>
{{ end }}

<div class="clear"></div>

{{ partial "footer.html" . }}
